program: src/train_wandb.py
method: grid
metric:
    name: mAP
    goal: maximize

parameters:
    # --- data / splits ---
    episode_index:
        values: [0, 1, 2, 3]

    # --- model choice ---
    model_name:
        values: ['convnext_tiny', 'vitb16', 'effnetb0', 'effnetb2']

    # --- training knobs (shared) ---
    seed:
        values: [42]
    batch_size:
        values: [32]
    weight_decay:
        values: [0.001]
    threshold:
        values: [0.4]

    # --- 2-stage schedule (warmup -> finetune) ---
    warmup_epochs:
        values: [2]
    lr_head_warmup:
        values: [0.001]

    finetune_epochs:
        values: [5]
    unfreeze_last_n:
        values: [2]
    lr_head_finetune:
        values: [0.001]
    lr_backbone:
        values: [0.00003]
    llrd_gamma:
        values: [0.6]

    # --- bookkeeping ---
    project:
        value: ms_classifier
    group:
        value: rq1-backbones
